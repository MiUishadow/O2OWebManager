<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
	<!--自动热部署 -->
	<constant name="struts.devMode" value="true" />
	<!-- 默认上传文件大小 -->
	<constant name="struts.multipart.maxSize" value="100000000" />
	<constant name="struts.objectFactory" value="spring"></constant>
	<!-- 默认执行用户信息查询 并跳转到展示界面 -->
	<!-- 这里有一个bug 可以跳转到相应的页面，但是无法进入action 慎用 -->
	<!-- <package name="loginIndex" namespace="/" extends="struts-default"> 
		<default-action-ref name="index" /> <action name="loginIndex" class="com.all58.video.modules.user.action.LoginAction" 
		method="index"> <result name="login">/loginTest.jsp</result> </action> </package> -->
	<package name="jump" extends="struts-default" namespace="/jump">
		<action name="jumpAction" class="jumpAction">
			<result>/pages/Index.jsp</result>
			<result name="toSelect">/pages/Index2.jsp</result>
			<result name="toShop" type="chain">page3Action</result>
		</action>
		<action name="toReturn" class="jumpAction" method="toReturn">
			<result name="toReturn" type="redirect">${returnUrl}</result>
		</action>
		<action name="toLogin" class="jumpAction" method="toLogin">
			<result name="toLogin">/pages/login.jsp</result>
		</action>
		<action name="toReg" class="jumpAction" method="toReg">
			<result name="toReg">/pages/reg.jsp</result>
		</action>
		<action name="page3Action" class="page3Action">
			<result>/pages/Index3A.jsp</result>
		</action>
		<action name="items" class="items">
			<result>/test/topitemTest.jsp?category=${category}</result>
		</action>
	</package>
	<!-- <package name="user" extends="struts-default" namespace="/user"> <action 
		name="userAction" class="userAction"> <result>/pages/Index.jsp</result> <result 
		name="toSelect">/pages/Index2.jsp</result> <result name="toShop" type="redirectAction">page3/page3Action.action</result> 
		</action> </package> -->
	<package name="user" extends="json-default" namespace="/user">
		<action name="userLogin" class="userLogin" method="onLogin">
			<result type="json" name="success">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="userRegOnMail" class="userReg" method="onRegByMail">
			<result type="json" name="success">
				<param name="root">obj</param>
			</result>
			<result name="validCodeError" type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="validCode" class="validCodeAction">
			<result type="stream">
				<param name="contentType">image/jpeg</param>
				<param name="inputName">imageStream</param>
				<param name="bufferSize">2048</param>
			</result>
		</action>
		<action name="getvalidCode" class="validCodeAction" method="getCode">
			<result name="Code" type="json">
				<param name="root">obj</param>
			</result>
		</action>
	</package>
	<package name="page3" extends="struts-default" namespace="/page3">
		<action name="page3Action" class="page3Action">
			<result>/pages/Index3A.jsp</result>
		</action>
	</package>
	<package name="image" extends="struts-default" namespace="/image">
		<action name="getImage" class="getImage">
			<result type="stream">
				<param name="contentType">image/jpeg</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
	</package>
	<package name="item" extends="json-default" namespace="/item">
		<!-- 拦截器 -->
		<interceptors>
			<!-- 登录验证 -->
			<interceptor name="loginVerify"
				class="com.o2oweb.interceptors.LoginInterceptor">
			</interceptor>

			<interceptor-stack name="verify">
				<interceptor-ref name="loginVerify"></interceptor-ref>

				<!-- 必须要添加默认拦截器，不然会报错的。。。。 -->
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>
		<default-interceptor-ref name="verify"></default-interceptor-ref>
		<global-results>
			<result name="user" type="chain">loginInterceptorAction</result>
		</global-results>

		<action name="buyAction" class="buyAction">
			<result type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="levelAction" class="levelAction">
			<result type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="itemAction" class="itemAction">
			<result name="sublevel" type="json">
				<param name="root">obj</param>
			</result>
			<result name="toplevel" type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="orderAction" class="orderAction">
			<result type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="listOrder" class="orderListAction">
			<result type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="addressAction" class="addressAction">
			<result type="chain">listAddress</result>
		</action>
		<action name="listAddress" class="listAddress">
			<result type="json">
				<param name="root">obj</param>
			</result>
		</action>
		<action name="loginInterceptorAction" class="loginInterceptorAction">
			<result type="json">
				<param name="root">obj</param>
			</result>
		</action>
	</package>
	<!-- <include file="com/all58/video/modules/user/login.xml"></include> -->
</struts>
